# JS

## Velopert's Modern React

### useEffect

#### `useEffect`는 
1. 마운트 될 때 (컴포넌트가 처음 생성)
2. 언마운트 될 때 (컴포넌트가 사라짐)
3. 업데이트 될 때 (특정 props가 바뀜)

함수 내에서 특정 작업을 처리할 수 있다.

#### `useEffect`는 첫번째 인자로 함수를, 두번째 인자로 deps(의존값이 들어있는 배열)을 받는다.
```javascript
useEffect(() => {
    console.log('컴포넌트가 화면에 나타남')
    return () => {
        console.log('컴포넌트가 화면에서 사라짐')
    };
  }, [])
```

#### deps

##### 1. `deps`가 비어 있을 때

컴포넌트가 처음 나타날 때만 `useEffect`에 등록된 함수가 호출된다.

위의 예시에선 `console.log()` 부분이 컴포넌트가 처음 나타날 때만 출력된다.

컴포넌트가 사라질 때 `clean up` 함수가 호출된다.

##### 2. `deps`에 특정 값을 줄 때

컴포넌트가 처음 나타날 때와 사라질 때, 그리고 값이 바뀌기 직전에도 호출이 된다.

###### `useEffect` 안에서 사용하는 상태나 props가 있다면 `useEffect` 안의 `deps`에 넣어주어야 한다. 이게 정석이다.

이렇게 하지 않으면, `useEffect` 함수가 실행될 때 최신 props/상태를 가리키지 않게 된다.

그리고 특정 값이 업데이트 되어도 호출이 된다.

##### 3. `deps`를 아예 생략할 때

`deps` 파라미터를 생략하면, 컴포넌트가 리랜더링 될 때마다 호출이 된다.

ps. React는 부모 컴포넌트가 리랜더링 되면 자식 컴포넌트도 리랜더링 된다. 자식 컴포넌트가 바뀐 내용이 없을지라도. 실제 DOM에 반영되는건 바뀐 컴포넌트만 해당하지만 Virtual DOM에는 모든걸 다 렌더링 하는 것.

#### `useEffect`는 함수를 return 할 수 있는데 return 하는 힘수가 바로 `clean up` 함수이다.

`clean up`함수는 `useEffect`에 대한 뒷정리를 해주는 함수이다.

deps가 비어 있을 때는 언마운트 될 때 (컴포넌트가 사라질 때) `clean up` 함수가 호출된다.

