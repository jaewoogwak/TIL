# 버블링과 캡쳐링

이벤트의 흐름을 나타내는 표준 DOM 이벤트에서 정의한 3가지 단계는 다음과 같다.

1. 캡쳐링 단계 - 이벤트가 하위 요소로 전파되는 단계
2. 타겟 단계 - 이벤트가 실제 타깃 요소에 전달되는 단계
3. 버블링 단계 - 이벤트가 상위 요소로 전파되는 단계

## 버블링
이벤트가 발생한 요소부터 상위 요소로 이벤트가 전파되는 것을 버블링이라고 한다.

최하단부터 발생한 버블이 수면 위로 퍼져 올라가듯이 이벤트가 전파되어서 버블링이라는 이름이 붙었다.

<img width="409" alt="스크린샷 2022-08-07 오후 5 36 56" src="https://user-images.githubusercontent.com/62415600/183282781-15a4570c-60d3-4836-89a2-d3b60badee69.png">

### 이벤트 버블링을 막아보자

만약, 깊이 3으로 중첩된 `<div>`가 존재하고 각 요소에 클릭 이벤트가 할당되었다고 하자.

각 요소는 중첩되어 있음을 표현하는 `border` 속성이 존재해서 시각적으로 3개의 요소가 겹쳐져 있음을 확인할 수 있다.

유저가 가장 안쪽의 요소를 클릭하면 이 요소를 타고 가장 바깥쪽의 `<div>` 요소까지 이벤트가 전파되고 각 요소의 클릭 이벤트를 트리거시킬 것이다.

이를 막기 위해선 이벤트 객체의 `stopPropagination` 매서드를 사용한다.

해당 메서드를 선언하면 해당 요소의 부모 요소로 이벤트가 버블링되는 것을 막아준다.

## 캡쳐링

캡쳐링은 버블링과 반대로 이벤트를 타겟 요소에 전달하기 위해 DOM 트리 상에서 최상단 Window 객체부터 이벤트를 트리거시킨 요소까지 아래로 전파되는 것이다.

실제로 하위 요소로 이벤트가 캡쳐링되는 것을 확인하려면 `addEventListenr` 메서드에 `capture` 속성을 `true`로 지정하면 된다.

`addEventListener` 메서드는 기본적으로 클릭 이벤트 문자열과 콜백함수를 전달받으니, 세 번째 매개변수에 `true`를 전달하면 된다.

코드를 작성해보면 다음과 같다.

```javascript
<script>
  for(let elem of document.querySelectorAll('*')) {
    elem.addEventListener("click", e => alert(`캡쳐링: ${elem.tagName}`), true);
    elem.addEventListener("click", e => alert(`버블링: ${elem.tagName}`));
  }
</script>
```
